implementation,seq_len,d_model,dtype,forward_ms,backward_ms,end_to_end_ms
PyTorch,128,16,torch.bfloat16,0.022871373,0.074620641,0.247332385
FlashAttention-2,128,16,torch.bfloat16,0.006255724,1.631205655,1.774664323
PyTorch,128,16,torch.float32,0.024507457,0.034805708,0.24282656
FlashAttention-2,128,16,torch.float32,0.00755533,1.687026039,1.735085798
PyTorch,128,32,torch.bfloat16,0.021562699,0.030143469,0.227341176
FlashAttention-2,128,32,torch.bfloat16,0.010912094,2.032044799,2.392633575
PyTorch,128,32,torch.float32,0.025344773,0.038268479,0.22105998
FlashAttention-2,128,32,torch.float32,0.011757404,1.634260149,1.913786881
PyTorch,128,64,torch.bfloat16,0.021691566,0.052450768,0.238744923
FlashAttention-2,128,64,torch.bfloat16,0.008492208,1.74309843,2.720982256
PyTorch,128,64,torch.float32,0.024693398,0.042458686,0.174286966
FlashAttention-2,128,64,torch.float32,0.010403896,1.695630815,1.859681277
PyTorch,128,128,torch.bfloat16,0.018296953,0.023647434,0.197380103
FlashAttention-2,128,128,torch.bfloat16,0.010136443,1.71680431,1.886602448
PyTorch,128,128,torch.float32,0.022765342,0.031917899,0.270154879
FlashAttention-2,128,128,torch.float32,0.011065731,2.332152563,2.346618659
PyTorch,256,16,torch.bfloat16,0.02208,0.074809476,0.263616001
FlashAttention-2,256,16,torch.bfloat16,0.008039349,2.279283819,2.476664811
PyTorch,256,16,torch.float32,0.024378907,0.047475039,0.279833263
FlashAttention-2,256,16,torch.float32,0.010142787,2.12883784,2.228172488
PyTorch,256,32,torch.bfloat16,0.021570491,0.064876274,0.281913635
FlashAttention-2,256,32,torch.bfloat16,0.016826381,1.726763433,2.075121649
PyTorch,256,32,torch.float32,0.024188445,0.053602081,0.260998142
FlashAttention-2,256,32,torch.float32,0.017033496,1.638271334,1.948846972
PyTorch,256,64,torch.bfloat16,0.019044381,0.037446356,0.415542737
FlashAttention-2,256,64,torch.bfloat16,0.0123472,1.876875529,2.929890652
PyTorch,256,64,torch.float32,0.022930451,0.188214183,0.348626957
FlashAttention-2,256,64,torch.float32,0.01498916,2.05641015,2.166465592
PyTorch,256,128,torch.bfloat16,0.019827199,0.029452465,0.260564763
FlashAttention-2,256,128,torch.bfloat16,0.015129448,2.251984381,2.424782741
PyTorch,256,128,torch.float32,0.024742151,0.075346804,0.326838245
FlashAttention-2,256,128,torch.float32,0.017050572,2.05363067,2.250516814
PyTorch,512,16,torch.bfloat16,0.025270543,0.046277703,0.301437888
FlashAttention-2,512,16,torch.bfloat16,0.012037895,2.303071213,2.504269474
PyTorch,512,16,torch.float32,0.036069934,0.162237484,0.415953026
FlashAttention-2,512,16,torch.float32,0.016321038,2.190098627,2.305252426
PyTorch,512,32,torch.bfloat16,0.021896401,0.071176406,0.330734203
FlashAttention-2,512,32,torch.bfloat16,0.028515053,2.162525716,2.387454363
PyTorch,512,32,torch.float32,0.03301403,0.095801011,0.280548809
FlashAttention-2,512,32,torch.float32,0.028147828,2.012854335,1.857168324
PyTorch,512,64,torch.bfloat16,0.023475561,0.032424124,0.25225109
FlashAttention-2,512,64,torch.bfloat16,0.019602107,1.731796897,1.872273027
PyTorch,512,64,torch.float32,0.028789905,0.067481659,0.297961268
FlashAttention-2,512,64,torch.float32,0.024840701,2.048983348,2.174276793
PyTorch,512,128,torch.bfloat16,0.025596866,0.096549392,0.332572892
FlashAttention-2,512,128,torch.bfloat16,0.025963414,2.161483689,3.257354403
PyTorch,512,128,torch.float32,0.032621165,0.094203091,0.362325578
FlashAttention-2,512,128,torch.float32,0.028928,1.799205887,2.033641134
PyTorch,1024,16,torch.bfloat16,0.035170676,0.098566058,0.449277351
FlashAttention-2,1024,16,torch.bfloat16,0.020395723,2.313487196,2.425934308
PyTorch,1024,16,torch.float32,0.04152316,0.054435721,0.230356816
FlashAttention-2,1024,16,torch.float32,0.027948037,2.177994407,2.352559578
PyTorch,1024,32,torch.bfloat16,0.034477797,0.044029483,0.267194855
FlashAttention-2,1024,32,torch.bfloat16,0.052613174,2.370912796,2.451122852
PyTorch,1024,32,torch.float32,0.043595156,0.056347485,0.370403185
FlashAttention-2,1024,32,torch.float32,0.051481006,1.802429532,1.904124796
PyTorch,1024,64,torch.bfloat16,0.036176823,0.04632724,0.208016
FlashAttention-2,1024,64,torch.bfloat16,0.034731764,1.751303186,1.842781285
PyTorch,1024,64,torch.float32,0.048860013,0.063642666,0.275419026
FlashAttention-2,1024,64,torch.float32,0.044457084,1.75000453,2.099607641
PyTorch,1024,128,torch.bfloat16,0.038296976,0.048075875,0.251098667
FlashAttention-2,1024,128,torch.bfloat16,0.047609767,1.787567348,1.811259337
PyTorch,1024,128,torch.float32,0.056799796,0.0819826,0.189797076
FlashAttention-2,1024,128,torch.float32,0.053226562,1.695410713,1.720873601
PyTorch,2048,16,torch.bfloat16,0.074873858,0.094609622,0.210976413
FlashAttention-2,2048,16,torch.bfloat16,0.036466258,1.777935063,1.822897393
PyTorch,2048,16,torch.float32,0.111882547,0.166304599,0.262318354
FlashAttention-2,2048,16,torch.float32,0.050904841,1.664504746,1.80175934
PyTorch,2048,32,torch.bfloat16,0.078497526,0.082493857,0.328083363
FlashAttention-2,2048,32,torch.bfloat16,0.101249694,2.191890722,2.279579065
PyTorch,2048,32,torch.float32,0.110891626,0.162165139,0.273305196
FlashAttention-2,2048,32,torch.float32,0.098073988,2.071599234,2.1602958
PyTorch,2048,64,torch.bfloat16,0.081186747,0.083888799,0.278337313
FlashAttention-2,2048,64,torch.bfloat16,0.066394392,2.163169503,2.282763201
PyTorch,2048,64,torch.float32,0.125803456,0.189154308,0.314935588
FlashAttention-2,2048,64,torch.float32,0.085137265,2.082617443,2.149078149
PyTorch,2048,128,torch.bfloat16,0.085323929,0.098965333,0.24521635
FlashAttention-2,2048,128,torch.bfloat16,0.092279093,2.189292483,2.242496008
PyTorch,2048,128,torch.float32,0.144900703,0.222762344,0.377193386
FlashAttention-2,2048,128,torch.float32,0.101640746,2.118759995,2.186758061
PyTorch,4096,16,torch.bfloat16,0.345791797,0.422514358,0.699636882
FlashAttention-2,4096,16,torch.bfloat16,0.068596916,2.23095958,2.291558571
PyTorch,4096,16,torch.float32,0.72310401,1.112945629,1.87477493
FlashAttention-2,4096,16,torch.float32,0.098173395,2.139488725,2.133355676
PyTorch,4096,32,torch.bfloat16,0.353735197,0.388726381,0.6727686
FlashAttention-2,4096,32,torch.bfloat16,0.198179302,2.219192791,2.309194094
PyTorch,4096,32,torch.float32,0.727443008,1.104537487,1.789278698
FlashAttention-2,4096,32,torch.float32,0.190534077,2.098295084,2.189534443
PyTorch,4096,64,torch.bfloat16,0.356242717,0.393285725,0.691520006
FlashAttention-2,4096,64,torch.bfloat16,0.128392579,2.196201593,2.486617264
PyTorch,4096,64,torch.float32,0.778017006,1.183042756,1.948087456
FlashAttention-2,4096,64,torch.float32,0.164746114,2.119808004,2.190612506
PyTorch,4096,128,torch.bfloat16,0.367975386,0.426149593,0.733309748
FlashAttention-2,4096,128,torch.bfloat16,0.181490365,2.206483191,2.328153259
PyTorch,4096,128,torch.float32,0.849893335,1.321218035,2.176874149
FlashAttention-2,4096,128,torch.float32,0.199747554,2.192017177,2.45206235
PyTorch,8192,16,torch.bfloat16,1.85938857,2.448385821,4.225840005
FlashAttention-2,8192,16,torch.bfloat16,0.132861043,2.760455765,2.890678925
PyTorch,8192,16,torch.float32,3.31890285,4.829940143,8.134714127
FlashAttention-2,8192,16,torch.float32,0.191482568,2.750877767,2.934005661
PyTorch,8192,32,torch.bfloat16,1.859483209,2.454022137,4.230511969
FlashAttention-2,8192,32,torch.bfloat16,0.391481265,2.732974264,3.268267835
PyTorch,8192,32,torch.float32,3.307481093,4.833480408,8.120226947
FlashAttention-2,8192,32,torch.float32,0.37646163,2.73471122,3.259326779
PyTorch,8192,64,torch.bfloat16,1.865210566,2.461995482,4.24798985
FlashAttention-2,8192,64,torch.bfloat16,0.253122813,2.778778463,3.02531555
PyTorch,8192,64,torch.float32,3.363543731,4.906928891,8.24616727
FlashAttention-2,8192,64,torch.float32,0.32783015,2.788844158,3.090358487
PyTorch,8192,128,torch.bfloat16,1.893211818,2.502328879,4.334751947
FlashAttention-2,8192,128,torch.bfloat16,0.703785937,3.177780912,3.887258194
PyTorch,8192,128,torch.float32,3.531310742,5.228245338,8.749061758
FlashAttention-2,8192,128,torch.float32,0.770995322,3.223360016,3.995096705
PyTorch,16384,16,torch.bfloat16,7.450770656,9.716060829,17.11205101
FlashAttention-2,16384,16,torch.bfloat16,0.263831601,10.81483996,11.06930804
PyTorch,16384,16,torch.float32,13.45947892,19.50451164,32.91093445
FlashAttention-2,16384,16,torch.float32,0.381272678,10.80967999,11.18307996
PyTorch,16384,32,torch.bfloat16,7.400169813,9.70341444,17.04382706
FlashAttention-2,16384,32,torch.bfloat16,0.787828768,10.94297206,11.71967098
PyTorch,16384,32,torch.float32,13.51282283,19.57847061,33.03901927
FlashAttention-2,16384,32,torch.float32,0.75316703,10.94287992,11.67629194
PyTorch,16384,64,torch.bfloat16,7.421691051,9.728575897,17.09834213
FlashAttention-2,16384,64,torch.bfloat16,0.910427061,11.10737205,11.99734838
PyTorch,16384,64,torch.float32,13.58818749,19.71965599,33.26259232
FlashAttention-2,16384,64,torch.float32,1.278318467,11.08554804,12.34821933
PyTorch,16384,128,torch.bfloat16,7.464125355,9.885354678,17.3159996
FlashAttention-2,16384,128,torch.bfloat16,2.791113034,12.26605688,15.15984011
PyTorch,16384,128,torch.float32,14.21556266,20.56600809,34.74176025
FlashAttention-2,16384,128,torch.float32,3.058430844,12.42144435,15.64042139
PyTorch,32768,16,torch.bfloat16,29.45321655,39.07799911,68.45126343
FlashAttention-2,32768,16,torch.bfloat16,0.970491596,42.9091835,43.83231926
Pytorch,32768,16,torch.float32,OOM,OOM,OOM
FlashAttention-2,32768,16,torch.float32,1.139316263,42.8738575,43.96940804
PyTorch,32768,32,torch.bfloat16,29.46356328,39.20128059,68.59356689
FlashAttention-2,32768,32,torch.bfloat16,2.243259858,43.64244843,45.84499168
Pytorch,32768,32,torch.float32,OOM,OOM,OOM
FlashAttention-2,32768,32,torch.float32,2.984152587,43.60278511,46.5986557
PyTorch,32768,64,torch.bfloat16,29.57648023,39.43726349,68.98483276
FlashAttention-2,32768,64,torch.bfloat16,3.550110826,43.74121475,47.26220703
Pytorch,32768,64,torch.float32,OOM,OOM,OOM
FlashAttention-2,32768,64,torch.float32,5.104595529,43.72582436,48.83767891
PyTorch,32768,128,torch.bfloat16,29.83113607,39.84527969,69.70674896
FlashAttention-2,32768,128,torch.bfloat16,11.17967975,47.66975975,59.56198502
Pytorch,32768,128,torch.float32,OOM,OOM,OOM
FlashAttention-2,32768,128,torch.float32,12.20435197,48.79257584,61.90393448
Pytorch,65536,16,torch.bfloat16,OOM,OOM,OOM
FlashAttention-2,65536,16,torch.bfloat16,OOM,OOM,OOM
Pytorch,65536,16,torch.float32,OOM,OOM,OOM
FlashAttention-2,65536,16,torch.float32,OOM,OOM,OOM
Pytorch,65536,32,torch.bfloat16,OOM,OOM,OOM
FlashAttention-2,65536,32,torch.bfloat16,OOM,OOM,OOM
Pytorch,65536,32,torch.float32,OOM,OOM,OOM
FlashAttention-2,65536,32,torch.float32,OOM,OOM,OOM
Pytorch,65536,64,torch.bfloat16,OOM,OOM,OOM
FlashAttention-2,65536,64,torch.bfloat16,OOM,OOM,OOM
Pytorch,65536,64,torch.float32,OOM,OOM,OOM
FlashAttention-2,65536,64,torch.float32,OOM,OOM,OOM
Pytorch,65536,128,torch.bfloat16,OOM,OOM,OOM
FlashAttention-2,65536,128,torch.bfloat16,OOM,OOM,OOM
Pytorch,65536,128,torch.float32,OOM,OOM,OOM
FlashAttention-2,65536,128,torch.float32,OOM,OOM,OOM
